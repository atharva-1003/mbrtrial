<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <!-- Fixed viewport meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <meta name="description" content="Login application" />
  <title>Login App</title>
</head>
<body>
  <div id="root">
    <!-- Keep a real form so it can still submit if JS is disabled -->
    <form action="/login" method="post" id="loginForm">
      <!-- Use type="button" so clicks are handled explicitly by our script (avoid accidental/default submits)
           We attach a robust handler below that will submit the form when appropriate or navigate to /login. -->
      <button type="button" id="loginButton">Login</button>
    </form>
  </div>

  <script>
  (function () {
    // Minimal, robust login handler:
    // - Ensures clicking the Login UI always either submits the form (if present) or navigates to the /login route.
    // - Avoids relying on brittle assumptions and prevents uncaught exceptions from leaving the button unresponsive.

    var form = document.querySelector('form[action="/login"]');
    var button = document.getElementById('loginButton');

    if (!button) {
      return; // nothing to attach to
    }

    function goToLogin() {
      try {
        if (form && typeof form.submit === 'function') {
          // Submit the form programmatically. This preserves method and any form fields.
          form.submit();
        } else {
          // Fallback navigation
          window.location.href = '/login';
        }
      } catch (err) {
        if (window && window.console) console.error('Error while navigating to /login', err);
        // Final fallback
        window.location.href = '/login';
      }
    }

    button.addEventListener('click', function (e) {
      // Prevent default behaviour to avoid unexpected native submits
      if (e && typeof e.preventDefault === 'function') {
        e.preventDefault();
      }
      // Small timeout to allow other handlers (if any) to run first
      setTimeout(goToLogin, 0);
    }, false);

    if (window && window.console) {
      console.log('Login button click handler attached');
    }
  })();
  </script>

  <noscript>
    This application requires JavaScript for client-side redirection. If JavaScript is disabled,
    <a href="/login">click here</a> to go to the login page.
  </noscript>
</body>
</html>
